<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Kaz Story ‚Äî –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å—É–≤–µ–Ω–∏—Ä–æ–≤</title>
  <style>
    :root {
      --bg: #f3efe7;
      --brand-dark: #1f3f33;
      --brand-accent: #b86a3c;
      --brand-light: #f7f1e4;
      --border-soft: #ded3bf;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", Arial, sans-serif;
      background: radial-gradient(circle at top, #faf5ea 0, var(--bg) 50%, #ebe3d3 100%);
      color: #2e2e2e;
    }
    header {
      background: #1f3f33;
      padding: 18px 20px;
      color: white;
      text-align: center;
      border-bottom: 1px solid rgba(255,255,255,0.15);
      position: relative;
    }
    header .logo {
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      font-weight: 700;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      font-size: 14px;
      opacity: 0.9;
    }
    .logo-mark {
      width: 22px;
      height: 22px;
      border-radius: 8px;
      border: 2px solid #f7f1e4;
      position: relative;
    }
    .logo-mark::before,
    .logo-mark::after {
      content:"";
      position:absolute;
      inset:4px;
      border-radius:6px;
      border:1px solid rgba(247,241,228,0.75);
    }
    .logo-mark::after {
      inset:9px;
      border-radius:50%;
    }
    .logo-text { letter-spacing: 0.16em; }
    header h1 {
      margin: 6px 0 0;
      font-size: 22px;
      font-weight: 600;
    }
    .lang-switch {
      position:absolute;
      top: 14px;
      right: 16px;
      display:flex;
      gap:6px;
    }
    .lang-btn {
      border:1px solid rgba(247,241,228,0.6);
      background:rgba(247,241,228,0.16);
      color:#f7f1e4;
      padding:4px 10px;
      border-radius:999px;
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.08em;
      cursor:pointer;
    }
    .lang-btn.active {
      background:#f7f1e4;
      color:#1f3f33;
    }

    .page {
      max-width: 1200px;
      margin: 24px auto 32px;
      padding: 0 16px;
    }
    .layout {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1fr);
      gap: 24px;
      align-items: flex-start;
    }
    @media (max-width: 880px) {
      .layout { grid-template-columns: 1fr; }
    }

    .panel {
      background: rgba(255,255,255,0.9);
      border-radius: 16px;
      padding: 20px 20px 18px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.08);
      border: 1px solid var(--border-soft);
      backdrop-filter: blur(6px);
    }
    .panel h2 {
      margin: 0 0 12px;
      font-size: 18px;
    }
    .panel p.meta {
      margin: 0 0 18px;
      font-size: 13px;
      color: #6d6d6d;
    }

    .group-label {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: #777;
      margin: 18px 0 8px;
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .chip {
      padding: 8px 14px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      background: #f7f1e4;
      font-size: 13px;
      cursor: pointer;
      transition: all .18s ease;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .chip span.icon { font-size: 14px; }
    .chip.active {
      background: #1f3f33;
      color: #f7f1e4;
      border-color: #1f3f33;
      box-shadow: 0 6px 16px rgba(10,30,24,0.35);
    }

    .color-row {
      display: flex;
      gap: 10px;
      margin-top: 4px;
    }
    .color-dot {
      width: 26px;
      height: 26px;
      border-radius: 50%;
      border: 2px solid transparent;
      cursor: pointer;
      box-shadow: 0 0 0 1px rgba(0,0,0,0.06);
      position: relative;
    }
    .color-dot.active {
      border-color: #1f3f33;
      box-shadow: 0 0 0 2px rgba(31,63,51,0.35);
    }
    .color-dot::after {
      content: "";
      position: absolute;
      inset: 4px;
      border-radius: inherit;
      border: 1px solid rgba(255,255,255,0.6);
    }

    select {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid var(--border-soft);
      font-size: 14px;
      background: #fdfaf4;
    }

    .preview-panel {
      position: relative;
      overflow: hidden;
      padding: 32px 20px;
      border-radius: 18px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.18);
      background: linear-gradient(145deg, #f7f1e4 0%, #e7ddcc 45%, #d5c7b0 100%);
    }
    .preview-header {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #777;
      margin-bottom: 10px;
    }

    .preview-card { border-radius: 22px; padding: 26px 22px; height: 360px; position: relative; color: #fdfaf4; box-shadow: 0 18px 48px rgba(0,0,0,0.45); display: flex; flex-direction: column; justify-content: space-between; overflow: hidden; backdrop-filter: blur(3px); border:1px solid rgba(255,255,255,0.25); }
    }

    .badge-type {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,0.22);
    }

    .preview-main { filter: drop-shadow(0 10px 20px rgba(0,0,0,0.45));
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .preview-icon {
      width: 120px;
      height: 160px;
      position: relative;
    }
    .preview-icon .shape {
      position: absolute;
      inset: 0;
      border-radius: 28px 28px 18px 18px;
      border: 3px solid rgba(255,255,255,0.86);
    }

    /* –§–æ—Ä–º—ã –ø–æ–¥ —Ç–∏–ø—ã —Å—É–≤–µ–Ω–∏—Ä–∞ */
    .preview-icon[data-type="magnet"] .shape {
      border-radius: 999px;
      width: 110px;
      height: 110px;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
    }
    .preview-icon[data-type="keychain"] .shape {
      border-radius: 20px;
      width: 70px;
      height: 130px;
      top: 14px;
      left: 50%;
      transform: translateX(-50%);
    }
    .preview-icon[data-type="poster"] .shape {
      border-radius: 10px;
      width: 90px;
      height: 130px;
      top: 18px;
      left: 50%;
      transform: translateX(-50%);
    }
    .preview-icon[data-type="sticker"] .shape {
      border-radius: 40% 60% 50% 70%;
      border-style: dashed;
    }

    /* –í–∞—Ä–∏–∞–Ω—Ç—ã —ç–ª–µ–º–µ–Ω—Ç–∞ –≤–Ω—É—Ç—Ä–∏ */
    .preview-icon[data-element="bayterek"]::before,
    .preview-icon[data-element="bozzhyra"]::before,
    .preview-icon[data-element="ornament"]::before,
    .preview-icon[data-element="city"]::before {
      content: "";
      position: absolute;
      inset: 18px 20px 22px;
      border-radius: 18px;
      border: 2px solid rgba(255,255,255,0.85);
      box-shadow: 0 16px 26px rgba(0,0,0,0.35);
    }

    .preview-icon[data-element="bayterek"]::after {
      content: "";
      position: absolute;
      left: 50%;
      top: 26px;
      width: 56px;
      height: 56px;
      margin-left: -28px;
      border-radius: 50%;
      border: 3px solid rgba(255,255,255,0.92);
      box-shadow: 0 10px 26px rgba(0,0,0,0.4);
    }

    .preview-icon[data-element="bozzhyra"]::after {
      content: "";
      position: absolute;
      inset: 46px 24px 20px;
      border-radius: 46% 46% 18% 18%;
      border-top: 3px solid rgba(255,255,255,0.95);
      border-left: 3px solid rgba(255,255,255,0.9);
      border-right: 3px solid rgba(255,255,255,0.9);
    }

    .preview-icon[data-element="ornament"]::after {
      content: "";
      position: absolute;
      inset: 30px 30px;
      border-radius: 18px;
      border: 3px dashed rgba(255,255,255,0.9);
      box-shadow: 0 0 0 1px rgba(0,0,0,0.18);
    }

    .preview-icon[data-element="city"]::after {
      content: "";
      position: absolute;
      left: 18px;
      right: 18px;
      bottom: 22px;
      height: 52px;
      border-radius: 10px 10px 4px 4px;
      border-top: 3px solid rgba(255,255,255,0.9);
      box-shadow: 0 -14px 28px rgba(0,0,0,0.45);
    }

    .preview-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      opacity: 0.92;
      margin-top: 12px;
    }
    .preview-footer strong { font-size: 13px; }

    .tag {
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.6);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: .09em;
    }

    .style-pill {
      font-size: 11px;
      text-transform: uppercase;
      opacity: .9;
    }
    .preview-img {
      position:absolute;
      inset: 26px 26px 40px;
      width: calc(100% - 52px);
      height: auto;
      max-height: 100%;
      object-fit: cover;
      border-radius: 18px;
      box-shadow: 0 12px 26px rgba(0,0,0,0.4);
      display: none;
    }
    .preview-quote {
      position:absolute;
      left: 22px;
      right: 22px;
      bottom: 24px;
      font-size: 11px;
      line-height: 1.4;
      text-align: left;
      text-shadow: 0 1px 3px rgba(0,0,0,0.7);
      display: none;
    }
    .preview-icon[data-ornament="koskar"] .shape { border-style: solid; }
    .preview-icon[data-ornament="tumar"] .shape { border-radius: 10px 32px 18px 32px; }
    .preview-icon[data-ornament="spiral"] .shape { border-style: dotted; }
    .preview-icon[data-ornament="geo"] .shape { border-radius: 8px; }

    .download-btn {
      margin-top: 12px;
      width: 100%;
      padding: 10px 14px;
      border-radius: 999px;
      border: none;
      background: var(--brand-dark);
      color: #f7f1e4;
      font-size: 13px;
      letter-spacing: .08em;
      text-transform: uppercase;
      cursor: pointer;
      box-shadow: 0 10px 24px rgba(0,0,0,0.18);
    }
    .download-btn:hover { background: #264a3a; }
      
  </style>
</head>
<body>
  <header>
            <div class="logo">
      <span class="logo-mark" aria-hidden="true"></span>
      <span class="logo-text">KazArt Souvenir</span>
    </div>
    <div class="lang-switch">
      <button id="lang-ru" class="lang-btn active">RU</button>
      <button id="lang-en" class="lang-btn">EN</button>
    </div>
    <h1 id="title-main">My Kaz Story ‚Äî –æ–Ω–ª–∞–π–Ω‚Äë–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å—É–≤–µ–Ω–∏—Ä–æ–≤</h1>
  </header>

  <main class="page">
    <div class="layout">
      <section class="panel" aria-label="–ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å—É–≤–µ–Ω–∏—Ä–∞">
        <h2 id="panel-title">–°–æ–∑–¥–∞–π —Å–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Å—É–≤–µ–Ω–∏—Ä</h2>
        <p class="meta" id="panel-meta">–í—ã–±–µ—Ä–∏ —Ñ–æ—Ä–º–∞—Ç, —Å—Ç–∏–ª—å, —Ü–≤–µ—Ç –∏ –≤–∏–∑—É–∞–ª—å–Ω—ã–π –º–æ—Ç–∏–≤ ‚Äî –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–ø—Ä–∞–≤–∞ –æ–±–Ω–æ–≤–∏—Ç—Å—è —Å—Ä–∞–∑—É.</p>

        <div class="group-label" id="label-type">1. –¢–∏–ø —Å—É–≤–µ–Ω–∏—Ä–∞</div>
        <div class="chip-row" id="type-row">
          <button class="chip active" data-type="magnet"><span class="icon">üß≤</span> –ú–∞–≥–Ω–∏—Ç</button>
          <button class="chip" data-type="keychain"><span class="icon">üîë</span> –ë—Ä–µ–ª–æ–∫</button>
          <button class="chip" data-type="poster"><span class="icon">üñº</span> –ú–∏–Ω–∏‚Äë–ø–æ—Å—Ç–µ—Ä</button>
          <button class="chip" data-type="sticker"><span class="icon">üí†</span> –°—Ç–∏–∫–µ—Ä</button>
        </div>

        <div class="group-label" id="label-style">2. –°—Ç–∏–ª—å</div>
        <div class="chip-row" id="style-row">
          <button class="chip active" data-style="nature">Nature Art</button>
          <button class="chip" data-style="heritage">Heritage Art</button>
          <button class="chip" data-style="urban">Urban Art</button>
        </div>

        <div class="group-label" id="label-color">3. –¶–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞</div>
        <div class="color-row" id="color-row">
          <div class="color-dot active" data-color="steppe" title="–°—Ç–µ–ø–Ω–æ–π –∑–µ–ª—ë–Ω—ã–π" style="background:#355f46"></div>
          <div class="color-dot" data-color="terracotta" title="–¢–µ—Ä—Ä–∞–∫–æ—Ç–∞" style="background:#b8683c"></div>
          <div class="color-dot" data-color="sand" title="–ü–µ—Å–æ—á–Ω—ã–π –±–µ–∂" style="background:#d9c3a2"></div>
          <div class="color-dot" data-color="night" title="–ù–æ—á–Ω–æ–π –≥—Ä–∞—Ñ–∏—Ç" style="background:#222325"></div>
        </div>

        <div class="group-label" id="label-element">4. –í–∏–∑—É–∞–ª—å–Ω—ã–π –º–æ—Ç–∏–≤</div>
        <select id="element-select">
          <option value="bayterek">–ê—Å—Ç–∞–Ω–∞ ‚Äî –ë–∞–π—Ç–µ—Ä–µ–∫</option>
          <option value="bozzhyra">–ú–∞–Ω–≥—ã—Å—Ç–∞—É ‚Äî –ë–æ–∑–∂—ã—Ä–∞</option>
          <option value="ornament">–ö–∞–∑–∞—Ö—Å–∫–∏–π –æ—Ä–Ω–∞–º–µ–Ω—Ç</option>
          <option value="city">–ì–æ—Ä–æ–¥—Å–∫–æ–π skyline</option>
        </select>

        <div class="group-label" id="label-ornament">5. –û—Ä–Ω–∞–º–µ–Ω—Ç—ã</div>
        <div class="chip-row" id="ornament-row">
          <button class="chip" data-ornament="koskar">“ö–æ—à“õ–∞—Ä –º“Ø–π—ñ–∑</button>
          <button class="chip" data-ornament="tumar">–¢“±–º–∞—Ä</button>
          <button class="chip" data-ornament="spiral">–°–ø–∏—Ä–∞–ª—å</button>
          <button class="chip" data-ornament="geo">–ì–µ–æ–º–µ—Ç—Ä–∏—è</button>
        </div>

        <div class="group-label" id="label-image">6. –ö–∞—Ä—Ç–∏–Ω–∫–∞</div>
        <div class="chip-row" id="image-row">
          <button class="chip" data-image="baiterek-img">–ë–∞–π—Ç–µ—Ä–µ–∫</button>
          <button class="chip" data-image="bozzhyra-img">–ë–æ–∑–∂—ã—Ä–∞</button>
          <button class="chip" data-image="city-img">Skyline</button>
        </div>

        <div class="group-label" id="label-upload">7. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–æ—ë –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>
        <input type="file" id="upload" accept="image/*" style="margin-bottom:12px;" />

        <div class="group-label" id="label-quote">8. –¶–∏—Ç–∞—Ç–∞</div>
        <input
          type="text"
          id="quoteInput"
          placeholder="–í–≤–µ–¥–∏—Ç–µ —Ü–∏—Ç–∞—Ç—É"
          style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border-soft);"
        />
      </section>

      <section class="panel preview-panel" aria-label="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å—É–≤–µ–Ω–∏—Ä–∞">
        <div class="preview-header" id="preview-header">–û–Ω–ª–∞–π–Ω‚Äë–ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</div>
        <div class="preview-card" id="preview-card">
          <div class="badge-type" id="badge-type">üß≤ –ú–ê–ì–ù–ò–¢</div>
          <div class="preview-main">
            <div class="preview-icon" id="preview-icon" data-element="bayterek" data-type="magnet">
              <div class="shape"></div>
              <img id="preview-img" class="preview-img" alt="–ü—Ä–µ–≤—å—é —Å—É–≤–µ–Ω–∏—Ä–∞" />
              <div id="preview-quote" class="preview-quote"></div>
            </div>
          </div>
          <div class="preview-footer">
            <div>
              <div class="style-pill" id="style-pill">Nature Art ¬∑ —Å—Ç–µ–ø–Ω–æ–π –∑–µ–ª—ë–Ω—ã–π</div>
              <strong id="element-label">–ê—Å—Ç–∞–Ω–∞ ¬∑ –ë–∞–π—Ç–µ—Ä–µ–∫</strong>
            </div>
            <div class="tag" id="tag-label">My Kaz Story</div>
          </div>
        </div>
        <button class="download-btn" type="button" id="download-btn">–°–∫–∞—á–∞—Ç—å –ø—Ä–µ–≤—å—é</button>
      </section>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script>
    // ===== –Ø–ó–´–ö RU / EN =====
    let currentLang = 'ru';
    const I18N = {
      ru: {
        title: 'My Kaz Story ‚Äî –æ–Ω–ª–∞–π–Ω‚Äë–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å—É–≤–µ–Ω–∏—Ä–æ–≤',
        create: '–°–æ–∑–¥–∞–π —Å–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Å—É–≤–µ–Ω–∏—Ä',
        meta: '–í—ã–±–µ—Ä–∏ —Ñ–æ—Ä–º–∞—Ç, —Å—Ç–∏–ª—å, —Ü–≤–µ—Ç –∏ –≤–∏–∑—É–∞–ª—å–Ω—ã–π –º–æ—Ç–∏–≤ ‚Äî –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–ø—Ä–∞–≤–∞ –æ–±–Ω–æ–≤–∏—Ç—Å—è —Å—Ä–∞–∑—É.',
        preview: '–û–Ω–ª–∞–π–Ω‚Äë–ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä',
        download: '–°–∫–∞—á–∞—Ç—å –ø—Ä–µ–≤—å—é',
      },
      en: {
        title: 'My Kaz Story ‚Äî online souvenir builder',
        create: 'Create your personal souvenir',
        meta: 'Choose format, style, color and visual motif ‚Äî the preview on the right updates instantly.',
        preview: 'Live preview',
        download: 'Download preview',
      },
    };

    function applyLang(lang) {
      currentLang = lang;
      const t = I18N[lang];
      document.getElementById('title-main').textContent = t.title;
      document.getElementById('panel-title').textContent = t.create;
      document.getElementById('panel-meta').textContent = t.meta;
      document.getElementById('preview-header').textContent = t.preview;
      document.getElementById('download-btn').textContent = t.download;
      document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
      document.getElementById(lang === 'ru' ? 'lang-ru' : 'lang-en').classList.add('active');
    }

    document.getElementById('lang-ru').addEventListener('click', () => applyLang('ru'));
    document.getElementById('lang-en').addEventListener('click', () => applyLang('en'));

    // ===== –°–û–°–¢–û–Ø–ù–ò–ï –ò –≠–õ–ï–ú–ï–ù–¢–´ =====
    const state = {
      type: 'magnet',
      style: 'nature',
      color: 'steppe',
      element: 'bayterek',
      ornament: '',
      image: '',
      customImage: '',
      quote: '',
    };

    const typeRow = document.getElementById('type-row');
    const styleRow = document.getElementById('style-row');
    const colorRow = document.getElementById('color-row');
    const elementSelect = document.getElementById('element-select');

    const previewCard = document.getElementById('preview-card');
    const previewIcon = document.getElementById('preview-icon');
    const badgeType = document.getElementById('badge-type');
    const stylePill = document.getElementById('style-pill');
    const elementLabel = document.getElementById('element-label');
    const tagLabel = document.getElementById('tag-label');
    const ornamentRow = document.getElementById('ornament-row');
    const imageRow = document.getElementById('image-row');
    const uploadInput = document.getElementById('upload');
    const previewImg = document.getElementById('preview-img');
    const previewQuote = document.getElementById('preview-quote');
    const downloadBtn = document.getElementById('download-btn');

    const TYPE_BADGE = {
      ru: {
        magnet: 'üß≤ –ú–ê–ì–ù–ò–¢',
        keychain: 'üîë –ë–†–ï–õ–û–ö',
        poster: 'üñº –ú–ò–ù–ò‚Äë–ü–û–°–¢–ï–†',
        sticker: 'üí† –°–¢–ò–ö–ï–†',
      },
      en: {
        magnet: 'üß≤ MAGNET',
        keychain: 'üîë KEYCHAIN',
        poster: 'üñº MINI POSTER',
        sticker: 'üí† STICKER',
      },
    };

    const STYLE_LABELS = {
      nature: 'Nature Art',
      heritage: 'Heritage Art',
      urban: 'Urban Art',
    };

    const COLOR_MAP = {
      steppe: { bg: '#355f46', nameRu: '—Å—Ç–µ–ø–Ω–æ–π –∑–µ–ª—ë–Ω—ã–π', nameEn: 'steppe green' },
      terracotta: { bg: '#b8683c', nameRu: '—Ç–µ—Ä—Ä–∞–∫–æ—Ç–∞', nameEn: 'terracotta' },
      sand: { bg: '#c8a982', nameRu: '–ø–µ—Å–æ—á–Ω—ã–π –±–µ–∂', nameEn: 'sand beige' },
      night: { bg: '#222325', nameRu: '–Ω–æ—á–Ω–æ–π –≥—Ä–∞—Ñ–∏—Ç', nameEn: 'night graphite' },
    };

    const ELEMENT_LABELS = {
      ru: {
        bayterek: '–ê—Å—Ç–∞–Ω–∞ ¬∑ –ë–∞–π—Ç–µ—Ä–µ–∫',
        bozzhyra: '–ú–∞–Ω–≥—ã—Å—Ç–∞—É ¬∑ –ë–æ–∑–∂—ã—Ä–∞',
        ornament: '–û—Ä–Ω–∞–º–µ–Ω—Ç ¬∑ “ö–æ—à“õ–∞—Ä –º“Ø–π—ñ–∑',
        city: '–ì–æ—Ä–æ–¥ ¬∑ Skyline',
      },
      en: {
        bayterek: 'Astana ¬∑ Bayterek',
        bozzhyra: 'Mangystau ¬∑ Bozzhyra',
        ornament: 'Ornament ¬∑ Qoshqar muyiz',
        city: 'City ¬∑ Skyline',
      },
    };

    function updatePreview() {
      const c = COLOR_MAP[state.color];
      const colorName = currentLang === 'ru' ? c.nameRu : c.nameEn;

      // —Ñ–æ–Ω
      previewCard.style.background = c.bg;

      // —Ç–∏–ø + —Ñ–æ—Ä–º–∞
      badgeType.textContent = TYPE_BADGE[currentLang][state.type];
      previewIcon.dataset.type = state.type;

      // —ç–ª–µ–º–µ–Ω—Ç + —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–µ–ª–µ–∫—Ç–∞
      if (state.image === 'baiterek-img') state.element = 'bayterek';
      if (state.image === 'bozzhyra-img') state.element = 'bozzhyra';
      if (state.image === 'city-img') state.element = 'city';

      elementSelect.value = state.element;
      previewIcon.dataset.element = state.element;

      // –æ—Ä–Ω–∞–º–µ–Ω—Ç
      previewIcon.dataset.ornament = state.ornament || '';

      // –ø–æ–¥–ø–∏—Å–∏
      elementLabel.textContent = ELEMENT_LABELS[currentLang][state.element];
      stylePill.textContent = `${STYLE_LABELS[state.style]} ¬∑ ${colorName}`;
      tagLabel.textContent = state.style === 'urban' ? 'KazUrban Story' : 'My Kaz Story';

      // –∫–∞—Ä—Ç–∏–Ω–∫–∞
      if (state.customImage) {
        previewImg.src = state.customImage;
        previewImg.style.display = 'block';
      } else {
        previewImg.removeAttribute('src');
        previewImg.style.display = 'none';
      }

      // —Ü–∏—Ç–∞—Ç–∞
      previewQuote.textContent = state.quote;
      previewQuote.style.display = state.quote ? 'block' : 'none';
    }

    function handleChipRow(row, key) {
      row.addEventListener('click', (e) => {
        const btn = e.target.closest('.chip');
        if (!btn) return;
        row.querySelectorAll('.chip').forEach(ch => ch.classList.remove('active'));
        btn.classList.add('active');
        state[key] = btn.dataset[key];
        updatePreview();
      });
    }

    handleChipRow(typeRow, 'type');
    handleChipRow(styleRow, 'style');
    handleChipRow(ornamentRow, 'ornament');
    handleChipRow(imageRow, 'image');

    colorRow.addEventListener('click', (e) => {
      const dot = e.target.closest('.color-dot');
      if (!dot) return;
      colorRow.querySelectorAll('.color-dot').forEach(d => d.classList.remove('active'));
      dot.classList.add('active');
      state.color = dot.dataset.color;
      updatePreview();
    });

    elementSelect.addEventListener('change', (e) => {
      state.element = e.target.value;
      updatePreview();
    });

    if (uploadInput) {
      uploadInput.addEventListener('change', (e) => {
        const file = e.target.files && e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (event) => {
          state.customImage = event.target.result;
          state.image = 'custom';
          updatePreview();
        };
        reader.readAsDataURL(file);
      });
    }

    function updateQuote() {
      const input = document.getElementById('quoteInput');
      state.quote = input.value.trim();
      updatePreview();
    }

    document.getElementById('quoteInput').addEventListener('input', updateQuote);

    if (downloadBtn) {
      downloadBtn.addEventListener('click', async () => {
        if (typeof html2canvas === 'undefined') {
          alert('–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø—Ä–µ–≤—å—é –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ —Å–∞–π—Ç–∞.');
          return;
        }
        const canvas = await html2canvas(previewCard);
        const link = document.createElement('a');
        link.download = 'my-kaz-story.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
      });
    }

    // —Å—Ç–∞—Ä—Ç: —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫ –∏ –ø–µ—Ä–≤–∏—á–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä
    applyLang('ru');
    updatePreview();
  </script>
</body>
</html>
